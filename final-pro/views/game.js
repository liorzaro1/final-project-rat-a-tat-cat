// const cardsToSave = require('../cardsToSave/Version01/cardsToSave.JSON');

// const cardsToSaveAsStringFromJSON = JSON.stringify(cardsToSave);
// console.log(cardsToSaveAsStringFromJSON/*.toString()*/);

const cardsToSave = [
    {
        "cardId": 0,
        "cardName":0,
        "cardUrls": {
                "cardImgPrimaryUrl":"./cardsImg/card0.jpg",
                "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 1,
        "cardName":0,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card0.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 2,
        "cardName":0,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card0.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 3,
        "cardName":0,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card0.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 4,
        "cardName":1,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card1.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 5,
        "cardName":1,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card1.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 6,
        "cardName":1,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card1.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 7,
        "cardName":1,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card1.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 8,
        "cardName":2,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card2.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 9,
        "cardName":2,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card2.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 10,
        "cardName":2,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card2.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 11,
        "cardName":2,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card2.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 12,
        "cardName":3,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card3.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 13,
        "cardName":3,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card3.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 14,
        "cardName":3,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card3.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 15,
        "cardName":3,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card3.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 16,
        "cardName":4,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card4.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 17,
        "cardName":4,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card4.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 18,
        "cardName":4,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card4.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 19,
        "cardName":4,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card4.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 20,
        "cardName":5,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card5.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 21,
        "cardName":5,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card5.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 22,
        "cardName":5,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card5.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 23,
        "cardName":5,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card5.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 24,
        "cardName":6,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card6.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 25,
        "cardName":6,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card6.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 26,
        "cardName":6,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card6.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 27,
        "cardName":6,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card6.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 28,
        "cardName":7,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card7.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 29,
        "cardName":7,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card7.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 30,
        "cardName":7,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card7.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 31,
        "cardName":7,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card7.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 32,
        "cardName":8,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card8.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 33,
        "cardName":8,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card8.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 34,
        "cardName":8,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card8.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 35,
        "cardName":8,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card8.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 36,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 37,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 38,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 39,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 40,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 41,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 42,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 43,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 44,
        "cardName":9,
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card9.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": false
    },
    {
        "cardId": 45,
        "cardName":"Draw-2",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-draw-2.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 46,
        "cardName":"Draw-2",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-draw-2.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 47,
        "cardName":"Draw-2",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-draw-2.png",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 48,
        "cardName":"Swap",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-swap.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 49,
        "cardName":"Swap",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-swap.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 50,
        "cardName":"Swap",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-swap.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 51,
        "cardName":"Peek",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-peek.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 52,
        "cardName":"Peek",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-peek.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    },
    {
        "cardId": 53,
        "cardName":"Peek",
        "cardUrls": {
            "cardImgPrimaryUrl":"./cardsImg/card-peek.jpg",
            "cardImgSecondaryUrl": "./cardsImg/card-background.jpg"
        },
        "isSpecial": true
    }
];

let gameComponents;
let counter = 0;
let curCards = [];

console.log("cards to save:")
for(let card of cardsToSave) {
    console.log(card);
}

function shuffleCards() {
    let originalCards = [];
    for(let card of cardsToSave) {
        originalCards.push(card);
    }

    console.log("original cards:")
    for(let card of cardsToSave) {
        console.log(card);
    }
    let shuffledCards = new Array(originalCards.length);
    for(let i=0; i<shuffledCards.length; i++) {
        let randomPlace = Math.floor(Math.random()*(originalCards.length));
        shuffledCards[i] = originalCards[randomPlace];
        originalCards.splice(randomPlace,1);
    }
    console.log("shuffledCards:");
    for(let card of shuffledCards) {
        console.log(card);
    }
    return shuffledCards;
}

function createPlayersCardPlaces(playersNum=2) { // playersNum should be sent to this function from game menu!!!!
    const playersArr = [];
    for(let i=0; i<playersNum; i++) {
        playersArr.push([]);
    }
    console.log(`empty players Arrs: ${JSON.stringify(playersArr)}`);
    // for (let playerArr of playersArr) {
    //     console.log(`playerArr: ${playerArr}`);
    // }
    return playersArr;
}

function dealCards(playersNum=2) { // playersNum should be sent to this function from game menu!!!!
    let cardsToDeal = shuffleCards();
    const playersArrCreated = createPlayersCardPlaces(playersNum);

    for(let i=0; i<4; i++) {
        for(let playerArr of playersArrCreated) {
            playerArr.push(cardsToDeal.splice(0,1)[0]);
        }
    }

    console.log("after dealing the cards: ");
    console.log("playersArrCreated with cards:");
    for(let playerArr of playersArrCreated) {
        console.log(JSON.stringify(playerArr));
        // for(card of playerArr) {
        //     console.log(card);
        // }   
    }

    const pile = [];

    gameComponents = {
        thePile: pile,
        theDeck: cardsToDeal,
        playersCards: playersArrCreated
    };

    // return gameComponents;
}

function initializeGame(playersNum=2) { // playersNum should be sent to this function from game menu!!!!
    dealCards(playersNum);
    document.getElementById("deck").style.backgroundImage = "url(" + gameComponents.theDeck[0].cardUrls.cardImgSecondaryUrl + ")";
    document.getElementById("deck").style.backgroundRepeat = "no-repeat";
    document.getElementById("deck").style.backgroundSize = "cover";
    document.getElementById("deck").disabled = true;
    document.getElementById("ratATatCat").disabled = true;


    document.getElementById("pile").style.backgroundRepeat = "no-repeat";
    document.getElementById("pile").style.backgroundSize = "cover";
    document.getElementById("pile").disabled = true;

    let player1Cards = document.getElementsByClassName("player1Card");
    let player2Cards = document.getElementsByClassName("player2Card");
    let player3Cards = document.getElementsByClassName("player3Card");
    let player4Cards = document.getElementsByClassName("player4Card");
    let player5Cards = document.getElementsByClassName("player5Card");
    let player6Cards = document.getElementsByClassName("player6Card");

    console.log(`Player 1 cards from game components: ${JSON.stringify(gameComponents.playersCards[0][0].cardUrls)}`);
    for(let i=0; i<4; i++) {
        player1Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][i].cardUrls.cardImgSecondaryUrl + ")";
        player1Cards[i].style.backgroundRepeat = "no-repeat";
        player1Cards[i].style.backgroundSize = "cover";
        player2Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][i].cardUrls.cardImgSecondaryUrl + ")";
        player2Cards[i].style.backgroundRepeat = "no-repeat";
        player2Cards[i].style.backgroundSize = "cover";
        player1Cards[i].disabled = true;
        player2Cards[i].disabled = true;
        player3Cards[i].disabled = true;
        player4Cards[i].disabled = true;
        player5Cards[i].disabled = true;
        player6Cards[i].disabled = true;
    }

    if (playersNum >= 3) {
        
        for(let i=0; i<4; i++) {
            player3Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[2][i].cardUrls.cardImgSecondaryUrl + ")";
            player3Cards[i].style.backgroundRepeat = "no-repeat";
            player3Cards[i].style.backgroundSize = "cover";
            
        }
    }

    if (playersNum >= 4) {
        
        for(let i=0; i<4; i++) {
            player4Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[3][i].cardUrls.cardImgSecondaryUrl + ")";
            player4Cards[i].style.backgroundRepeat = "no-repeat";
            player4Cards[i].style.backgroundSize = "cover";
            
        }
    }

    if (playersNum >= 5) {
        
        for(let i=0; i<4; i++) {
            player5Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[4][i].cardUrls.cardImgSecondaryUrl + ")";
            player5Cards[i].style.backgroundRepeat = "no-repeat";
            player5Cards[i].style.backgroundSize = "cover";
            
        }
    }

    if (playersNum == 6) {
        
        for(let i=0; i<4; i++) {
            player6Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[5][i].cardUrls.cardImgSecondaryUrl + ")";
            player6Cards[i].style.backgroundRepeat = "no-repeat";
            player6Cards[i].style.backgroundSize = "cover";
            
        }
    } 
    console.log("from initializeGame() here are gameComponents: gameComponents.theDeck:" + JSON.stringify(gameComponents.theDeck) + " gameComponents.thePile:" + JSON.stringify(gameComponents.thePile) + " gameComponents.playersCards:" + JSON.stringify(gameComponents.playersCards)); 
}

function firstPeek(playersNum=2) {
    let player1EndCards = document.getElementsByClassName("player1EndCard");
    let player2EndCards = document.getElementsByClassName("player2EndCard");
    let player1EndCardsTxt = document.getElementsByClassName("player1EndCardTxt");
    let player2EndCardsTxt = document.getElementsByClassName("player2EndCardTxt");
    let gameGuideTxt = document.getElementById("gameGuideTxt");

    let j;
    for(let i=0;i<2; i++) {
        if (i===1) {
            j=i+2;
            player1EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][j].cardUrls.cardImgPrimaryUrl + ")";
            player1EndCardsTxt[i].innerHTML= gameComponents.playersCards[0][j].cardName;
        }
        else {
            player1EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][i].cardUrls.cardImgPrimaryUrl + ")";
            player1EndCardsTxt[i].innerHTML= gameComponents.playersCards[0][i].cardName;
        }

        player1EndCards[i].style.backgroundRepeat = "no-repeat";
        player1EndCards[i].style.backgroundSize = "cover";

        gameGuideTxt.innerHTML = "First Peek For 5 seconds: Player1 Peeks End Cards";
        setTimeout(()=> {
            if (i===1) {
                j=i+2;
                player1EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][j].cardUrls.cardImgSecondaryUrl + ")";
            }
            else {
                player1EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][i].cardUrls.cardImgSecondaryUrl + ")";
            }
            player1EndCards[i].style.backgroundRepeat = "no-repeat";
            player1EndCards[i].style.backgroundSize = "cover";
            player1EndCardsTxt[i].innerHTML = "Player 1";
            if (i===1) {
                j=i+2;
                player2EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][j].cardUrls.cardImgPrimaryUrl + ")";
                player2EndCardsTxt[i].innerHTML= gameComponents.playersCards[1][j].cardName;
            }
            else {
                player2EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][i].cardUrls.cardImgPrimaryUrl + ")";
                player2EndCardsTxt[i].innerHTML= gameComponents.playersCards[1][i].cardName;
            }
            player2EndCards[i].style.backgroundRepeat = "no-repeat";
            player2EndCards[i].style.backgroundSize = "cover";
            gameGuideTxt.innerHTML = "First Peek For 5 seconds: Player2 Peeks End Cards";
        }, 5000);
        setTimeout(()=> {
            if (i===1) {
                j=i+2;
                player2EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][j].cardUrls.cardImgSecondaryUrl + ")";
            }
            else {
                player2EndCards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][i].cardUrls.cardImgSecondaryUrl + ")";
            }
            player2EndCards[i].style.backgroundRepeat = "no-repeat";
            player2EndCards[i].style.backgroundSize = "cover";
            player2EndCardsTxt[i].innerHTML = "Player 2";
            gameGuideTxt.innerHTML = "Player 1 Turn";
            document.getElementById("deck").disabled = false;
            document.getElementById("ratATatCat").disabled = false;
        }, 10000);
    }
    // think about more than 2 players!!!
}

// function gameFlow(id, idTxt) {
//     let currentCard; 
//     if(id==="pile" && gameComponents.thePile.length===0) {
//         if (gameComponents.thePile.length===0) {
//             alert("The pile is currently empty! Please draw a card from the deck");
//         }
//         else {
//             currentCard = gameComponents.thePile[thePile.length-1]
//         }  
//     }
//     else {
//         document.getElementById(id).style.backgroundImage = "url(" + gameComponents.theDeck[0].cardUrls.cardImgPrimaryUrl + ")";
//         document.getElementById(idTxt).innerHTML = gameComponents.theDeck[0].cardName;
//         currentCard = gameComponents.theDeck[0];
//         gameComponents.theDeck.splice(0,1);
//     }
// }

function specialOperation(id, idTxt) {

}

function gameFlow(id, idTxt) {
    let gameGuideTxt = document.getElementById("gameGuideTxt");
    let player1Cards = document.getElementsByClassName('player1Card');
    let player2Cards = document.getElementsByClassName('player2Card');
    console.log("curCards before: " + JSON.stringify(curCards));
    if (counter<2) {
        if (counter==0) {
            if(id==="deck") {
                document.getElementById(id).style.backgroundImage = "url(" + gameComponents.theDeck[0].cardUrls.cardImgPrimaryUrl + ")";
                document.getElementById(idTxt).innerHTML = gameComponents.theDeck[0].cardName;
                if(!gameComponents.theDeck[0].isSpecial) {
                    curCards.push(gameComponents.theDeck[0]);
                    gameComponents.theDeck.splice(0,1);
                    document.getElementById(id).disabled=true;
                    if(gameGuideTxt.innerHTML==='Player 1 Turn') {
                        for(let i=0;i<player1Cards.length;i++) {
                            player1Cards[i].disabled=false;
                        }
                    }
                    else {
                        for(let i=0;i<player2Cards.length;i++) {
                            player2Cards[i].disabled=false;
                        }
                    }
                    counter++;
                    console.log("curCards middle1: " + JSON.stringify(curCards));
                }
                else {
                    gameComponents.thePile.push(gameComponents.theDeck[0]);
                    gameComponents.theDeck.splice(0,1);
                    document.getElementById('pile').style.backgroundImage = "url(" + gameComponents.thePile[gameComponents.thePile.length-1].cardUrls.cardImgPrimaryUrl + ")";
                    document.getElementById('pileTxt').innerHTML = gameComponents.thePile[gameComponents.thePile.length-1].cardName;
                    document.getElementById('pile').disabled=true;

                    specialOperation(document.getElementById('pile'),document.getElementById('pileTxt'));
                    if(gameGuideTxt.innerHTML==='Player 1 Turn') {
                        document.getElementById("gameGuideTxt").innerHTML = 'Player 2 Turn';
                    }
                    else {
                        document.getElementById("gameGuideTxt").innerHTML = 'Player 1 Turn';
                    }
                    for(let i=0;i<player1Cards.length;i++) {
                        player1Cards[i].disabled=true;
                        player2Cards[i].disabled=true;
                    }
                    document.getElementById(id).style.backgroundImage = "url(" + gameComponents.theDeck[0].cardUrls.cardImgSecondaryUrl + ")";
                    document.getElementById(idTxt).innerHTML = 'Deck';
                    document.getElementById(id).disabled=false;
                    document.getElementById('pile').disabled=false;
                    curCards=[];
                    counter=0;
                }
            }
            else if(id==="pile") {
                curCards.push(gameComponents.thePile[gameComponents.thePile.length-1]);
                gameComponents.thePile.splice(gameComponents.thePile.length-1,1);
                document.getElementById(id).disabled=true;
                if(gameGuideTxt.innerHTML==='Player 1 Turn') {
                    for(let i=0;i<player1Cards.length;i++) {
                        player1Cards[i].disabled=false;
                    }
                }
                else {
                    for(let i=0;i<player2Cards.length;i++) {
                        player2Cards[i].disabled=false;
                    }
                }
                counter++;
            }
            document.getElementById("ratATatCat").disabled = true;
        }
        else {
            if(gameGuideTxt.innerHTML==='Player 1 Turn') {
                if(id==='Player1LeftCard') {
                    curCards.push(gameComponents.playersCards[0][0]);
                    gameComponents.playersCards[0][0] = curCards[0];
                }
                else if(id==='Player1LeftMiddleCard') {
                    curCards.push(gameComponents.playersCards[0][1]);
                    gameComponents.playersCards[0][1] = curCards[0];
                }
                else if(id==='Player1RightMiddleCard') {
                    curCards.push(gameComponents.playersCards[0][2]);
                    gameComponents.playersCards[0][2] = curCards[0];
                }
                else {
                    curCards.push(gameComponents.playersCards[0][3]);
                    gameComponents.playersCards[0][3] = curCards[0];
                }   
            }
            else {
                if(id==='Player2LeftCard') {
                    curCards.push(gameComponents.playersCards[1][0]);
                    gameComponents.playersCards[1][0] = curCards[0];
                }
                else if(id==='Player2LeftMiddleCard') {
                    curCards.push(gameComponents.playersCards[1][1]);
                    gameComponents.playersCards[1][1] = curCards[0];
                }
                else if(id==='Player2RightMiddleCard') {
                    curCards.push(gameComponents.playersCards[1][2]);
                    gameComponents.playersCards[1][2] = curCards[0];
                }
                else {
                    curCards.push(gameComponents.playersCards[1][3]);
                    gameComponents.playersCards[1][3] = curCards[0];
                }  
            } 
            counter++;
            console.log("curCards middle2: " + JSON.stringify(curCards));
        }
        
    }
    if (counter==2) {
        gameComponents.thePile.push(gameComponents.theDeck[0]);


        document.getElementById('deck').style.backgroundImage = "url(" + gameComponents.theDeck[0].cardUrls.cardImgSecondaryUrl + ")";
        document.getElementById('deckTxt').innerHTML = 'Deck';
        document.getElementById('deck').disabled=false;
        document.getElementById('pile').disabled=false;
        document.getElementById('pile').style.backgroundImage = "url(" + gameComponents.thePile[gameComponents.thePile.length-1].cardUrls.cardImgPrimaryUrl + ")";
        document.getElementById('pileTxt').innerHTML = gameComponents.thePile[gameComponents.thePile.length-1].cardName;
        curCards=[];
        counter=0;
        console.log("curCards end: " + JSON.stringify(curCards));
        document.getElementById("ratATatCat").disabled = false;
        if(gameGuideTxt.innerHTML==='Player 1 Turn') {
            for(let i=0;i<player1Cards.length;i++) {
                player1Cards[i].disabled=true;
            }
            document.getElementById("gameGuideTxt").innerHTML = 'Player 2 Turn';
        }
        else {
            for(let i=0;i<player1Cards.length;i++) {
                player2Cards[i].disabled=true;
            }
            document.getElementById("gameGuideTxt").innerHTML = 'Player 1 Turn';
        }
    }   
}

function ratATatCat(playersNum=2) {
    document.getElementById("gameGuideTxt").innerHTML = "Round Is Over!";
    let deck = document.getElementById("deck");
    let pile = document.getElementById("pile");
    deck.disabled = true;
    pile.disabled = true;
    let player1Cards = document.getElementsByClassName("player1Card");
    let player2Cards = document.getElementsByClassName("player2Card");
    let player1CardsTxt = document.getElementsByClassName("player1CardTxt");
    let player2CardsTxt = document.getElementsByClassName("player2CardTxt");
    let player1ScoreTxt = document.getElementById("player1ScoreTxt"); 
    let player2ScoreTxt = document.getElementById("player2ScoreTxt");
    let player1Score = 0; 
    let player2Score = 0; 
    for(let i=0;i<4;i++) {
        player1Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[0][i].cardUrls.cardImgPrimaryUrl + ")";
        player1Cards[i].style.backgroundRepeat = "no-repeat";
        player1Cards[i].style.backgroundSize = "cover";
        player1Cards[i].disabled = true;
        player1CardsTxt[i].innerHTML = gameComponents.playersCards[0][i].cardName;
        player1Score += gameComponents.playersCards[0][i].isSpecial?10:gameComponents.playersCards[0][i].cardName; 
        player2Cards[i].style.backgroundImage = "url(" + gameComponents.playersCards[1][i].cardUrls.cardImgPrimaryUrl + ")";
        player2Cards[i].style.backgroundRepeat = "no-repeat";
        player2Cards[i].style.backgroundSize = "cover";
        player2Cards[i].disabled = true;
        player2CardsTxt[i].innerHTML = gameComponents.playersCards[1][i].cardName;
        player2Score += gameComponents.playersCards[1][i].isSpecial?10:gameComponents.playersCards[1][i].cardName;
    }
    player1ScoreTxt.innerHTML = `Player 1 Score: ${player1Score}`;
    player2ScoreTxt.innerHTML = `Player 2 Score: ${player2Score}`;
    if(player1Score==player2Score) {
        player1ScoreTxt.innerHTML+= ' tie';
        player2ScoreTxt.innerHTML+= ' tie';
    }
    else if(player1Score<player2Score) {
        player1ScoreTxt.innerHTML+= ' win';
        player2ScoreTxt.innerHTML+= ' loose';
    }
    else {
        player1ScoreTxt.innerHTML+= ' loose';
        player2ScoreTxt.innerHTML+= ' win';
    }
}

setTimeout(()=>{
    initializeGame();
    firstPeek();
}, 0.1);